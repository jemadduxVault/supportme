 <div id="chat-show">
  <div id='chatbox'>
    <h1>Demo Chat</h1>

    <ul id="chat<%= @chat.id %>" class="chat_box">
      <%= render @messages %>
    </ul>

    <div id='chat-input'>
      <%= form_for Message.new, remote: true do |f| %>
        <%= f.text_field :content, class: "chat-input" %>
        <%= f.hidden_field :chat_id, value: @chat.id %>
        <%= f.hidden_field :author_id, value: @chat.customer_id %>
        <%= f.hidden_field :author_type, value: 'Customer' %>
        <%= f.submit "Send", class: "btn btn-success pull-right span3" %>
      <% end %>
    </div>
  </div>
</div>

<%= subscribe_to admin_chat_path(@chat) %>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>

  <script>
    var inIframe = false;

    var iframeClicker = function(){
      $('iframe[src^="http://localhost:3000"]')
        .bind('mouseover', function(){
          console.log('entered iframe');
          inIframe = true;
          if ( inIframe ) { $('#supportMe').css({height: "260"}); }
        })
        .bind('mouseout', function(){
          console.log('left iframe');
          inIframe = false;
          if ( inIframe == false ) { $('#supportMe').css({height: "40"}); }
        });
      };
    ;

    $(document).ready(function(){
      iframeClicker()
    })
  </script>

  <iframe id="supportMe" src="http://localhost:3000/customers/new" frameborder="0" overflow-x="hidden"; overflow-y= "scroll" style="position:fixed; left:70%; bottom:0px; z-index:1000; height:40px; width:260px; border:1px solid gray;"></iframe>
